<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-174131763-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-174131763-1');
    </script>
    
    <script defer src="https://use.fontawesome.com/releases/v5.0.8/js/fontawesome.js"
     integrity="sha384-7ox8Q2yzO/uWircfojVuCQOZl+ZZBg2D2J5nkpLqzH1HY0C1dHlTKIbpRz/LG23c" crossorigin="anonymous"></script>

    <title>Basic site for interactive tSNE plotting</title>

    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="css/style.css" rel="stylesheet">

    <!-- css -->
    <!-- <link rel="stylesheet" type="text/css" href="www/site_stylesheet.css"/> -->
    <!-- Import Vega & Vega-Lite (does not have to be from CDN) -->
    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@4"></script>
    <!-- Import vega-embed -->
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>

  </head>
  <body>
    <main role="main" class="container">
      <div class="container">
       <h1>Interactive 2D tSNE plotting of methylation markers</h1>
        <p>
         This plot is an interactive companion to the data that is detailed in our recent publication [DOI: <a href="https://dx.doi.org/10.21203/rs.2.13274/v1" target="blank">10.21203/rs.2.13274/v1</a>]. <br>
         Code and data can be found <a href="https://github.com/sirselim/tSNE_plotting" target="blank">here</a>.
        </p>
        <figure>
        <p><i><b>Note:</b> The plot below is able to be dragged and zoomed using the mouse. To reset the plot double click anywhere on it.</i></p>
        <div id="vis" style="text-align:center"></div>
        <figcaption><b>Figure:</b> tSNE plot of all 1173 methylation CpG sites which were selected as being cell type markers.</figcaption>
        </figure>
        <p style="width: 500px;">
          <blockquote><b>Citation:</b>
            <i>Donia Macartney-Coxson, Alanna Cameron, Jane Clapham, and Miles C Benton. DNA methylation in blood - potential to provide new insights in immune cell biology, 
            20 August 2019, PREPRINT (Version 1) available at Research Square [DOI: <a href="https://dx.doi.org/10.21203/rs.2.13274/v1" target="blank">10.21203/rs.2.13274/v1</a>]</i></blockquote>
        </p>
        <br>
        <hr>
        <br>
        <h4>Exploring cell-specific markers in other public data sets</h4>
        We set out to determine if the markers identified above would perform in independent public cell-sorted data sets. We identified the below studies as appropriate candidates for this validation:
        <ul>
          <li><a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE103541" target="blank">GSE103541</a> - [Illumina EPIC] 145 samples (<b>140 used</b> in this validation); <b>DNA methylation profiles for CD4 T cells, CD8 T cells, B cells, Monocytes and Granulocytes purified from 28 individuals.</b></li>
          <li><a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE110554" target="blank">GSE110554</a> - [Illumina EPIC] 49 samples (<b>49 used</b> in this validation); Salas LA, Koestler DC, Butler RA, Hansen HM et al. <b><i>An optimized library for reference-based deconvolution of whole-blood biospecimens assayed using the Illumina Human Methylation EPIC BeadArray</i>.</b> Genome Biol 2018 May 29;19(1):64. PMID: <a href="https://pubmed.ncbi.nlm.nih.gov/29843789/" target="">29843789</a></li>
          <li><a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE82084" target="blank">GSE82084</a> - [Illumina 450K] 36 samples (<b>22 used</b> in this validation); de Goede OM, Lavoie PM, Robinson WP. <b><i>Cord blood hematopoietic cells from preterm infants display altered DNA methylation patterns</i>.</b> Clin Epigenetics 2017;9:39. PMID: <a href="https://pubmed.ncbi.nlm.nih.gov/28428831/" target="blsnk">28428831</a></li>
        </ul>
        Two of these three data sets were generated on the Illumina EPIC platform, while our marker panel is derived from Illumina 450K array data. We identified a total of 1025 CpG sites that overlapped the original panel of 1173 markers. This drop is due to a combination of some probes not being present on the EPIC platform and some samples having missing data (with resultant probes being dropped).
        <br>
        <figure>
        <div id="vis2" style="text-align:center"></div>
        <figcaption><b>Figure:</b> tSNE plot of sorted-cells from 211 samples based on 1025 methylation CpG (overlapping with the three selected data sets).</figcaption>
        </figure>
        <br>
        <hr>
        The below figure is a re-creation of the above including the cell-sorted data from Reinius 2012 (<a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE35069" target="blank";>GSE35069</a>) - the data set which was used to identify the 1173 cell-specific CpG markers.
        <figure>
        <div id="vis3" style="text-align:center"></div>
        <figcaption><b>Figure:</b> tSNE plot of sorted-cells from 271 samples based on 1025 methylation CpG (the three selected data sets plus the original Reinius data set use to identify the markers).</figcaption>
        </figure>
        <br>
        <hr>
        The below figure depicts expression (RNASeq) data from cell-sorted populations - <a href="https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE107011" target="blank";>GSE107011</a>
        <figure>
        <div id="vis4" style="text-align:center"></div>
        <figcaption><b>Figure:</b> tSNE plot of sorted-cells from the RNASeq study GSE107011. This analysis was performed on expression data (TPM) from 11 genes, these are the same 11 genes that we validated the expression of in our experiment (QRTPCR)</figcaption>
        </figure>
        <br>
        <hr>
        <h4>Testing - large visualisations</h4>
        This section explores using t-sne on a large number of methylation CpG sites and then tries to visualise the results in an interactive manner.
        <br>
        [TESTING] - this <a href="img/test_large_tsne_plot.html">link</a> explores a very large data set using <a href="https://bokeh.org/" target="blank">bokeh</a>, be warned there be dragons!
        <br>
        <hr>
      </div>
    </main>

    <!-- vegalite embed -->
    <script type="text/javascript">
      var spec =
        "https://raw.githubusercontent.com/sirselim/tSNE_plotting/master/scripts/tsne_scatterplot.vl.json";
      vegaEmbed("#vis", spec)
        .then(function (result) {
          // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
        })
        .catch(console.error);
    </script>

    <!-- vegalite embed -->
    <script type="text/javascript">
      var spec =
        "https://raw.githubusercontent.com/sirselim/tSNE_plotting/master/scripts/tsne_scatterplot_public.vl.json";
      vegaEmbed("#vis2", spec)
        .then(function (result) {
          // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
        })
        .catch(console.error);
    </script>

    <!-- vegalite embed -->
    <script type="text/javascript">
      var spec =
        "https://raw.githubusercontent.com/sirselim/tSNE_plotting/master/scripts/tsne_scatterplot_public_all.vl.json";
      vegaEmbed("#vis3", spec)
        .then(function (result) {
          // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
        })
        .catch(console.error);
    </script>

    <!-- vegalite embed -->
    <script type="text/javascript">
      var spec =
        "https://raw.githubusercontent.com/sirselim/tSNE_plotting/master/scripts/tsne_scatterplot_exprs.vl.json";
      vegaEmbed("#vis4", spec)
        .then(function (result) {
          // Access the Vega view instance (https://vega.github.io/vega/docs/api/view/) as result.view
        })
        .catch(console.error);
    </script>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="js/jquery-3.3.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
    integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="js/bootstrap.min.js"></script>
  </body>
</html>
